name: 🔁 Keep Render App Alive

on:
  schedule:
    - cron: "*/3 * * * *" # Alle 3 Minuten
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: 🔁 Sende Pings an Render
        run: |
          echo "🌐 GET /"
          curl -s -o /dev/null -w "%{http_code}" https://matchingflobot.onrender.com/

          echo ""
          echo "🌐 POST /webhook mit realistischem Telegram-Dummy"
          curl -s -o /dev/null -w "%{http_code}" -X POST https://matchingflobot.onrender.com/webhook \
            -H "Content-Type: application/json" \
            -d '{
              "update_id": 1,
              "message": {
                "message_id": 1,
                "from": {
                  "id": 999999,
                  "is_bot": false,
                  "first_name": "KeepAliveBot"
                },
                "chat": {
                  "id": 999999,
                  "type": "private"
                },
                "date": 1631022240,
                "text": "/start"
              }
            }'

          echo ""
          echo "✅ Beide Pings gesendet"
